PROMPT MACRO MSG
LEA DX,MSG
MOV AH,09H
INT 21H
ENDM
DATA SEGMENT
    MSG1 DB 10,13,"ENTER NO:$"
    MSG2 DB 10,13,"NO AFTER NON-OVERLAP : $"
    MSG3 DB 10,13,"ENTER INDEX FROM 1 TO 4 $"
    MSG4 DB 10,13,"NO AFTER OVERLAP : $"
    MSG5 DB 10,13,"$"
    A1 DW 05h DUP(0)
    A2 DW 05h DUP(0)
    C DB 05h
    D DB 05h
    E DB 05h
    G DB 00h
    F DB 00h
DATA ENDS

CODE SEGMENT
    ASSUME DS:DATA,CS:CODE
    START:
    MOV AX,DATA
    MOV DS,AX

    MOV SI,0000h
UP1:
    PROMPT MSG1
    CALL TAKE
    MOV DH,BH
    CALL TAKE
    MOV DL,BH
    MOV [A1+SI],DX
    INC SI
    INC SI
    DEC C
JNZ UP1
    CALL OVER
    CALL NOVER
    MOV AH,4CH
    INT 21H

OVER PROC NEAR

    PROMPT MSG3
    MOV AH,01h
    INT 21H
    CMP AL,39h
    SUB AL,30h
    MOV [F],AL
    MOV AH,[F]
    MOV CL,05h
    SUB CL,AH
    MOV [G],CL
    MOV SI,0000h
    PROMPT MSG4
UP4:
    PROMPT MSG5
    MOV BX,[A1+SI]
    CALL DISPLAYP
    MOV BX,[A1+SI]
    MOV BH,BL
    CALL DISPLAYP
    INC SI
    INC SI
    DEC F
JNZ UP4
    MOV SI,0000h

UP5:
    PROMPT MSG5
    MOV BX,[A1+SI]
    CALL DISPLAYP
    MOV BX,[A1+SI]
    MOV BH,BL
    CALL DISPLAYP
    INC SI
    INC SI
    DEC G
JNZ UP5

RET
OVER ENDP
NOVER PROC NEAR
    MOV SI,0000h
    MOV DI,0000h
UP2:
    MOV AX,[A1+SI]
    MOV [A2+DI],AX
    INC SI
    INC SI
    INC DI
    INC DI
    DEC D
JNZ UP2
    MOV DI,0000h
    PROMPT MSG2
UP3:
    PROMPT MSG5
    MOV BX,[A2+DI]
    CALL DISPLAYP
    MOV BX,[A2+DI]
    MOV BH,BL
    CALL DISPLAYP
    INC DI
    INC DI
    DEC E
JNZ UP3
RET
NOVER ENDP


TAKE PROC NEAR
    MOV AH,01h
    INT 21H
    CMP AL,39h
    JBE DOWN1
    SUB AL,07h
DOWN1: SUB AL,30h
    MOV CL,04h
    ROL AL,CL
    MOV BH,AL

    MOV AH,01h
    INT 21H
    CMP AL,39h
    JBE DOWN2
    SUB AL,07h
DOWN2: SUB AL,30h
    ADD BH,AL

    RET
TAKE ENDP

DISPLAYP PROC NEAR
    MOV CH,BH
    AND BH,0F0h
    MOV CL,04h
    ROL BH,CL
    CMP BH,09h
    JBE DOWN3
    ADD BH,07h
DOWN3: ADD BH,30h
    MOV DL,BH
    MOV AH,02h
    INT 21H

    AND CH,0Fh
    CMP CH,09h
    JBE DOWN4
    ADD CH,07h
DOWN4: ADD CH,30h
    MOV DL,CH
    MOV AH,02h
    INT 21H

    RET 
DISPLAYP ENDP

CODE ENDS
END START